<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org" th:replace="~{layout :: html}">
<head>
    <title>All Applications - Creditinder</title>
</head>
<body>
    <div th:fragment="content">
        <div class="d-flex justify-content-between align-items-center mb-4">
            <h2><i class="fas fa-list"></i> All Loan Applications</h2>
            <a href="/apply" class="btn btn-primary">
                <i class="fas fa-plus"></i> New Application
            </a>
        </div>
        
        <div th:if="${#lists.isEmpty(applications)}" class="text-center">
            <div class="alert alert-info">
                <h4>No Applications Yet</h4>
                <p>Be the first to submit a loan application!</p>
                <a href="/apply" class="btn btn-primary">Submit Application</a>
            </div>
        </div>
        
        <div th:if="${!#lists.isEmpty(applications)}" class="row">
            <div class="col-12">
                <div class="table-responsive">
                    <table class="table table-hover">
                        <thead class="table-dark">
                            <tr>
                                <th>Applicant</th>
                                <th>Amount</th>
                                <th>Purpose</th>
                                <th>Credit Score</th>
                                <th>Approval Rate</th>
                                <th>Total Votes</th>
                                <th>Submitted</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr th:each="app : ${applications}">
                                <td>
                                    <strong th:text="${app.applicantName}">John Doe</strong><br>
                                    <small class="text-muted" th:text="${app.employmentStatus}">Full-time</small>
                                </td>
                                <td>
                                    <span class="fw-bold text-success" 
                                          th:text="'$' + ${#numbers.formatDecimal(app.loanAmount, 0, 'COMMA', 2, 'POINT')}">$25,000</span>
                                </td>
                                <td th:text="${app.loanPurpose}">Home Improvement</td>
                                <td>
                                    <span class="badge credit-score-badge" 
                                          th:classappend="${app.creditScore >= 750} ? 'bg-success' : (${app.creditScore >= 700} ? 'bg-warning text-dark' : 'bg-danger')"
                                          th:text="${app.creditScore}">720</span>
                                </td>
                                <td>
                                    <div th:if="${app.totalVotes > 0}">
                                        <div class="progress" style="height: 20px;">
                                            <div class="progress-bar bg-success" role="progressbar" 
                                                 th:style="'width: ' + ${app.approvalPercentage} + '%'"
                                                 th:text="${#numbers.formatDecimal(app.approvalPercentage, 0, 2)} + '%'">75%</div>
                                        </div>
                                    </div>
                                    <span th:if="${app.totalVotes == 0}" class="text-muted">No votes yet</span>
                                </td>
                                <td>
                                    <span class="badge bg-primary" th:text="${app.totalVotes}">5</span><br>
                                    <small class="text-success" th:text="${app.approvalVotes} + ' ✓'">3 ✓</small>
                                    <small class="text-danger" th:text="${app.rejectionVotes} + ' ✗'">2 ✗</small>
                                </td>
                                <td>
                                    <small th:text="${#temporals.format(app.submittedAt, 'MMM dd, yyyy')}">Jan 15, 2024</small><br>
                                    <small class="text-muted" th:text="${#temporals.format(app.submittedAt, 'HH:mm')}">14:30</small>
                                </td>
                                <td>
                                    <a th:href="@{'/application/' + ${app.id}}" class="btn btn-sm btn-outline-primary">
                                        <i class="fas fa-eye"></i> View
                                    </a>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
        
        <div class="text-center mt-4">
            <a href="/swipe" class="btn btn-success">
                <i class="fas fa-hand-pointer"></i> Start Voting
            </a>
        </div>
    </div>
</body>
</html>
